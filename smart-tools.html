<script>
const backendURL = "https://shayan-smart-tools-backend.onrender.com";

let compressedBlob = null;

/* COMPRESS */
async function compressImage(){
  const file = document.getElementById("compressImage").files[0];
  const size = document.getElementById("targetSize").value;

  if(!file || !size){
    alert("Select image and enter size");
    return;
  }

  document.getElementById("status").innerText = "Processing... Please wait ⏳";

  const formData = new FormData();
  formData.append("image", file);
  formData.append("targetSize", size);

  const response = await fetch(backendURL + "/compress", {
    method:"POST",
    body:formData
  });

  compressedBlob = await response.blob();

  document.getElementById("status").innerText = "✅ Compression Complete!";
  document.getElementById("downloadBtn").style.display = "block";
}

/* DOWNLOAD */
function downloadCompressed(){
  if(!compressedBlob) return;

  const url = window.URL.createObjectURL(compressedBlob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "compressed.jpg";
  document.body.appendChild(a);
  a.click();
  a.remove();
}
</script>
